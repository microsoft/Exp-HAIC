var text = {
  "question": "text",
  "answer": "binary",
  "feedback": "nope",
  "questions": [{
      "question": "The AI diagnostic tool uses clinical information about the patient to determine whether a condition is present in a patient's scan.",
      "answer": "false",
      "feedback": "Incorrect. The AI diagnostic tool only uses the X-ray image and condition labels generated by expert radiologists to make recommendations."
    },
    {
      "question": " The estimated probability reported by the AI diagnostic tool represents the probability that a condition is present in the X-ray image.",
      "answer": "false",
      "feedback": "Incorrect. The estimated probability generated by the AI tool represents the probability that a condition is present in the X-ray image according to the AI diagnostic tool."
    },
    {
      "question": "Selecting 'Yes' when responding to 'Would you like to seek a second opinion?' means that you would consult a radiologist colleague on the finding in a real-world clinical setting.",
      "answer": "true",
      "feedback": "Incorrect. 'Yes' should be selected in response to this question when you would likely consult a colleague in making a decision."
    },
    {
      "question": "For every assessment, the answer to 'Do you think this condition is present in the X-ray?' for each of the 33 conditions is set to 'Not present' by default.",
      "answer": "true",
      "feedback": "Incorrect. In all tasks of this phase, the default for each condition is set to 'Not present' when you first view an image."
    },
    {
      "question": "For every assessment, the answer to 'What is the likelihood that this condition is present in the X-ray?' for each of the 33 conditions is set to '50%' by default.",
      "answer": "false",
      "feedback": "Incorrect. The answer is set to 0% and you should modify it whenever you think that the condition may be present."
    },
    {
      "question": "The conditions listed in the navigation bar on the right hand side of the web pages will contain a checkmark when the AI diagnostic tool predicts that the probability of the condition being present in the image is larger than 40%.",
      "answer": "false",
      "feedback": "Incorrect. An icon with a red triangle will appear next to the conditions for which the AI diagnostic tools's probability predictions are larger than 60%. Blue checkmarks will appear next to the conditions that you identified as present in the X-ray."
    },
    {
      "question": "Once you click 'Next' and submit your responses for a case, you cannot go back and edit your responses.",
      "answer": "true",
      "feedback": "Incorrect. You cannot go back and change your decisions once you hit 'Next' and submit your responses. Even if you might still manage to do that, please do not. It would compromise the validity of the results from our study!"
    }
  ]
}

function printquestion(index) {
  return '<p><b>' + (index + 1) + '. ' + text.questions[index].question + '</b></p>';
}

function multipleChoices(index) {
  var response = '<table class = "table table-hover table-borderless table-sm" >';
  response += "<td style= 'text-align:left'>&nbsp;<input class='form-check-input' type='radio' name='question" + index + "' id='question" + index + "-false' form='submit-info' value='false' required>";
  response += "<label class='form-check-label' style='font-weight:normal; text-align:center'>&nbsp; False &nbsp;</label>";
  response += "<input class='form-check-input' type='radio' name='question" + index + "' id='question" + index + "-true' form='submit-info' value='true' required>";
  response += "<label class='form-check-label' style='font-weight:normal; text-align:center'> &nbsp; True </label></td>";
  response += "</table><p>" + "</p>"
  response += "<div id='disp" + index + "' class = 'alert alert-danger' style = 'display: none'></div>"
  return response;
}

let questionText = document.getElementById("questiontext")
for (let i = 0; i < text.questions.length; i++) {
  questionText.innerHTML += printquestion(i);
  questionText.innerHTML += multipleChoices(i);
}

function getAnswer(index) {
  return text.questions[index].answer;
}

function getFeedback(index) {
  return text.questions[index].feedback;
}

function checkButton() {
  for (let i = 0; i < text.questions.length; i++) {
    var getSelectedValue = document.querySelector("input[name='question" + i + "']:checked");

    if (getSelectedValue != null) {
      if (getSelectedValue.value != getAnswer(i)) {
        document.getElementById("disp" + i + "").style.display = "block";
        document.getElementById("disp" + i + "").innerHTML = '' + getFeedback(i);
      } else {
        document.getElementById("disp" + i + "").style.display = "none";
      }
    } else {
      document.getElementById("disp" + i + "").style.display = "block";
      document.getElementById("disp" + i + "").innerHTML = "You must select an answer.";
    }
  }
  activateNext()
}


function activateNext() {
  if (checkResponses()) {
    document.getElementById("next-button").style.display = "block";
  } else {
    document.getElementById("next-button").style.visibility = "none";
  }


}

function checkResponses() {
  for (let i = 0; i < text.questions.length; i++) {
    var getSelectedValue = document.querySelector("input[name='question" + i + "']:checked");

    if (getSelectedValue != null) {
      if (getSelectedValue.value != getAnswer(i)) {

        return false;
      }
    } else {
      return false;
    }

  }
  return true;
}